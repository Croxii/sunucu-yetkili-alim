<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Yetkili Alım</title>
<style>
body {
  background:#f3f4f6;
  font-family:Arial, sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  color:#111827;
}

.box {
  background:#ffffff;
  padding:24px;
  width:420px;
  border-radius:8px;
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
}

h2 {
  text-align:center;
  margin-bottom:14px;
}

input, textarea, select, button {
  width:100%;
  margin-top:10px;
  padding:8px;
  border:1px solid #d1d5db;
  border-radius:5px;
  font-size:14px;
}

textarea {
  resize:none;
  height:70px;
}

button {
  background:#111827;
  color:#fff;
  border:none;
  cursor:pointer;
}

button:hover {
  background:#000;
}

.hidden { display:none; }

.card {
  border:1px solid #e5e7eb;
  padding:10px;
  margin-top:10px;
  border-radius:6px;
  font-size:14px;
}

.status {
  margin-top:8px;
  font-weight:bold;
}
</style>
</head>
<body>

<div class="box" id="formBox">
  <h2>Yetkili Başvurusu</h2>

  <input id="name" placeholder="Ad / Kullanıcı Adı">
  <input id="discord" placeholder="Discord kullanıcı adı">
  <input id="age" type="number" placeholder="Yaş">

  <select id="role">
    <option value="">Yetki Seç</option>
    <option>Rehber</option>
    <option>Moderatör</option>
  </select>

  <textarea id="why" placeholder="Neden seni seçmeliyiz?"></textarea>

  <button onclick="submitForm()">Başvuruyu Gönder</button>
  <button onclick="toggleCheck()">Başvuru Durumunu Sorgula</button>
  <button onclick="openAdmin()">Admin Panel</button>
</div>

<div class="box hidden" id="checkBox">
  <h2>Başvuru Durumu</h2>
  <input id="checkDiscord" placeholder="Discord kullanıcı adın">
  <button onclick="checkStatus()">Sorgula</button>
  <div id="result"></div>
  <button onclick="back()">Geri</button>
</div>

<div class="box hidden" id="adminBox">
  <h2>Admin Panel</h2>
  <div id="list"></div>
  <button onclick="closeAdmin()">Geri</button>
</div>

<script>
function submitForm() {
  const data = {
    name: name.value,
    discord: discord.value,
    age: age.value,
    role: role.value,
    why: why.value,
    status: "Beklemede"
  };

  const apps = JSON.parse(localStorage.getItem("apps") || "[]");
  apps.push(data);
  localStorage.setItem("apps", JSON.stringify(apps));

  alert("Başvurun alındı");
  document.querySelectorAll("input, textarea").forEach(e => e.value = "");
}

function toggleCheck() {
  formBox.classList.add("hidden");
  checkBox.classList.remove("hidden");
}

function back() {
  checkBox.classList.add("hidden");
  formBox.classList.remove("hidden");
}

function checkStatus() {
  const apps = JSON.parse(localStorage.getItem("apps") || "[]");
  const user = checkDiscord.value.trim();
  const found = apps.find(a => a.discord === user);

  if (!found) {
    result.innerHTML = "<div class='status'>Başvuru bulunamadı.</div>";
    return;
  }

  result.innerHTML = `
    <div class="status">
      Yetki: ${found.role}<br>
      Durum: ${found.status}
    </div>
  `;
}

function openAdmin() {
  const pass = prompt("Admin Şifresi:");
  if (pass !== "admin123") return;

  formBox.classList.add("hidden");
  adminBox.classList.remove("hidden");
  render();
}

function closeAdmin() {
  adminBox.classList.add("hidden");
  formBox.classList.remove("hidden");
}

function render() {
  const apps = JSON.parse(localStorage.getItem("apps") || "[]");
  list.innerHTML = "";

  apps.forEach((a,i) => {
    list.innerHTML += `
      <div class="card">
        <b>${a.name}</b> (${a.role})<br>
        ${a.discord} | ${a.age}<br>
        ${a.why}
        <div class="status">Durum: ${a.status}</div>
        <button onclick="setStatus(${i},'Onaylandı')">Onayla</button>
        <button onclick="setStatus(${i},'Reddedildi')">Reddet</button>
      </div>
    `;
  });
}

function setStatus(i, s) {
  const apps = JSON.parse(localStorage.getItem("apps"));
  apps[i].status = s;
  localStorage.setItem("apps", JSON.stringify(apps));
  render();
}
</script>

</body>
</html>

